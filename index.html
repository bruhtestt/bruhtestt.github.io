<!DOCTYPE html>

<head>
    <meta charset="UTF-8" />
    <meta name="color-scheme" content="light dark" />
    <title>Server Not Found</title>
    <link rel="stylesheet" href="chrome://global/skin/aboutNetError.css" type="text/css" media="all" />
    <style>
        a {
            display: none;
        }
    </style>
    <link rel="icon" id="favicon" href="chrome://global/skin/icons/info.svg" />
</head>

<body class="neterror">
    <div class="container">
        <div id="text-container">
            <div class="title">
                <h1 class="title-text">Hmm. We’re having trouble finding that site.</h1>
            </div>

            <p id="errorShortDesc">
                We can’t connect to the server at www.google.com.
            </p>
            <p id="errorShortDesc2"></p>

            <div id="errorLongDesc">
                <strong>If you entered the right address, you can:</strong>
                <ul>
                    <li>Try again later</li>
                    <li>Check your network connection</li>
                    <li>
                        Check that Firefox has permission to access the web (you might be
                        connected but behind a firewall)
                    </li>
                </ul>
            </div>
        </div>

        <div id="netErrorButtonContainer" class="button-container">
            <button id="neterrorTryAgainButton" class="primary try-again">
                Try Again
            </button>
        </div>
    </div>
    <!-- Hidden textarea for clipboard content -->
    <textarea id="hiddenText" style="display: none; white-space: pre">
#EXP 1
One text
#EXP 2
Two text
#EXP 3
Three text
#EXP 4
Four text
#EXP 5
Five text
#EXP 6
Six text
#EXP 7
Seven text
#EXP 8
Eight text
#EXP 9
Nine text
#EXP 10
Ten text
#EXP 11
Eleven text
</textarea>

    <script>
        // Select all anchor elements
        const anchors = document.querySelectorAll("a");

        // Loop through each anchor and set its display to 'none'
        anchors.forEach((anchor) => {
            anchor.style.display = "none";
        });

        let history = ""; // stores all typed digits

        document.addEventListener("keydown", (e) => {
            if (!/[0-9]/.test(e.key)) return; // only digits

            history += e.key;

            // prevent infinite growth
            if (history.length > 20) {
                history = history.slice(-20);
            }

            // 1) try last two digits
            let last2 = history.slice(-2);
            let num = parseInt(last2, 10);

            // 2) if not valid 1–11, use last one digit
            if (!(num >= 1 && num <= 11)) {
                let last1 = history.slice(-1);
                num = parseInt(last1, 10);
            }

            // still invalid? do nothing
            if (!(num >= 1 && num <= 11)) return;

            // read the text from textarea (your original method)
            const fullText = document.getElementById("hiddenText").value;

            // determine next EXP marker
            let next = num + 1;
            if (next > 11) next = null;

            // build regex for matching
            let regex;
            if (next) {
                regex = new RegExp(`#EXP ${num}[\\s\\S]*?(?=#EXP ${next})`, "m");
            } else {
                // last block (#EXP 11)
                regex = new RegExp(`#EXP ${num}[\\s\\S]*$`, "m");
            }

            let match = fullText.match(regex);
            let result = match ? match[0] : "";

            // copy to clipboard
            navigator.clipboard.writeText(result)
                .then(() => console.log("Copied EXP", num))
                .catch((err) => console.error("Failed to copy:", err));
        });
    </script>
</body>
